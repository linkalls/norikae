# 機能一覧

## 経路検索

### 基本機能

- 出発地・目的地・経由地の入力 (駅名 / スポット名)
- 日時指定 (出発時刻 / 到着時刻 / 終電)
- 並び順: ⚡速い / 🔄乗換少 / 💴安い
- 新幹線利用 ON/OFF

### オートコンプリート

- 日本語・読み仮名・ローマ字で検索
- 鉄道駅 / バス停 / 観光スポット対応
- 250ms デバウンスでリアルタイム候補表示

### 経路結果カード

各カードには以下の情報を表示:

| 項目           | 説明                                     |
| -------------- | ---------------------------------------- |
| 出発・到着時刻 | `HH:MM → HH:MM 目安`                     |
| 所要時間       | 総所要時間 (乗換待ち含む)                |
| 乗換回数       | 🟢直通 / 🔄乗換N回                       |
| 運賃           | 合計運賃 (¥XXX)                          |
| 駅数           | N駅経由                                  |
| 距離           | km                                       |
| 📋ボタン       | テキストサマリーをクリップボードにコピー |

### 経路詳細 (展開時)

| 項目           | 説明                                       |
| -------------- | ------------------------------------------ |
| 路線色トラック | 同じ列車の駅を同色の縦線でグループ化       |
| 路線名バッジ   | 各セグメントの路線名・会社名               |
| 駅到着時刻     | 出発時刻から均等配分した目安時刻           |
| 乗換マーカー   | セグメント間に🔄アイコンと「乗換」テキスト |
| 定期代グリッド | 1ヶ月 / 3ヶ月 / 6ヶ月の定期代              |
| 距離・CO₂      | 📏距離km / 🌿CO₂ g/人                      |

#### 路線色割り当て

Edge.Property.Color 属性から実際の路線色を取得:

```
徒歩 = Color 230,230,230 (RGB変換値) または RailName=="徒歩"
```

#### ホーム番号・列車情報 (detail=full 時)

| 項目             | 表示例           | ソース                               |
| ---------------- | ---------------- | ------------------------------------ |
| 出発ホーム番号   | 🚉 3番線発       | `Edge.Property.DepartureTrackNumber` |
| 到着ホーム番号   | 🚉 5番線着       | `Edge.Property.ArrivalTrackNumber`   |
| 訓程・行き先方面 | ▷ 新宿・中野方面 | `Edge.Property.Destination`          |
| 列車種別         | 急行             | `Edge.Property.TrainKind`            |
| 列車番号         | 1020M            | `Edge.Property.TrainNo`              |
| 編成両数         | 10両             | `Edge.Property.NumOfCar`             |

徒歩区間には `walkLabel` (出口名など) をバッジ表示。

## 検索履歴

- 最近の検索 8件を自動保存 (localStorage: `norikae-history`)
- 出発地・目的地が両方空のとき表示
- リスト項目をクリックで出発地・目的地を復元
- 個別削除 (×) / 全件削除ボタン

## URL 共有

- 検索実行時に URL を `?from=渋谷&to=新宿` に自動更新
- 🔗共有ボタン:
  - スマートフォン: Web Share API (ネイティブ共有シート)
  - デスクトップ: クリップボードにURLコピー → Toast通知
- 共有 URL にアクセスすると出発地・目的地が自動入力される

## 運行情報

- リアルタイム遅延・運転見合わせ情報
- 路線別カード表示 (会社名・路線名・更新時刻)
- ステータス色分け:
  - 正常: グレー
  - 一部遅延: オレンジ
  - 遅延: 黄色
  - 運転見合わせ: 赤
- エリア情報 (関東 在来線など) の広域表示対応
- 「現在、主要路線に遅延情報はありません」バナー (全路線正常時)
- 手動更新ボタン

## PWA (Progressive Web App)

- `manifest.json` によるインストール対応
- ホーム画面追加 (Android / iOS)
- テーマカラー: `#2563eb` (青)
- ショートカット: 経路検索 / 運行情報
- iOS Safari: `apple-mobile-web-app-capable` 設定済み

## 技術制限事項

| 制限                 | 理由                                                       |
| -------------------- | ---------------------------------------------------------- |
| 到着時刻は目安       | `detail=simple` 時は各駅のタイムスタンプが無い時間そのもの |
| ホーム番号は非定時有 | Edge.Propertyに含まれない路線/時間帚がある                 |
